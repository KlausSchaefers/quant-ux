"use strict";(self["webpackChunkquant_ux"]=self["webpackChunkquant_ux"]||[]).push([[323],{76500:function(t,e,s){s.d(e,{Z:function(){return m}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{class:[{MatcHelpIcon:!t.hasToolbar},{"MatcToolbarItem MatcNotification":t.hasToolbar}],on:{click:t.open}},[s("div",{attrs:{type:"button"}},[s("QIcon",{attrs:{icon:"Help"}}),t.newNotifications?s("span",{staticClass:"MatcNotificationBubble"},[t._v(t._s(t.newNotifications))]):t._e()],1)])},i=[],n=s(50124),o=s(48534),r=s(51804),l=s(55887),c=s(8387),h=s(99917),d=s(30512),u=s(75183),f={name:"HelpButton",mixins:[h.Z],props:["topic","subtopic","hasNotifications","hasToolbar"],data:function(){return{newNotifications:0}},components:{QIcon:u.Z},methods:{show:function(t,e){var s=this,a=new r.Z,i=new l.Z,n=i.div("MatcDialog MatcHelpDialog MatcPadding").build();a.popup(n,this.$el),setTimeout((function(){var a=s.$new(c.Z,{hasNotifications:!1});a.placeAt(n),a.setTopic(t),a.setSupTopic(e)}),300)},open:function(){var t=this;this.hasToolbar&&(d.Z.getUserService().setLastNotication(),this.newNotifications=0);var e=new r.Z,s=new l.Z,a=s.div("MatcDialog MatcHelpDialog MatcPadding").build();e.popup(a,this.$el),setTimeout((function(){var e=t.$new(c.Z,{hasNotifications:t.hasNotifications});e.placeAt(a),t.topic&&(e.setTopic(t.topic),e.setSupTopic(t.subtopic))}),300)},initNotification:function(){var t=this;return(0,o.Z)((0,n.Z)().mark((function e(){var s,a,i,o,r,l;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d.Z.getUserService().getLastNotication();case 2:if(s=e.sent,!s){e.next=11;break}return a=s.lastNotification,i=0,e.next=8,d.Z.getUserService().getNotications();case 8:for(o=e.sent,r=0;r<o.length;r++)l=o[r],l.lastUpdate>a&&i++;t.newNotifications=i;case 11:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.hasNotifications&&this.initNotification()}},p=f,b=s(1001),v=(0,b.Z)(p,a,i,!1,null,null,null),m=v.exports},10785:function(t,e,s){s.d(e,{Z:function(){return b}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcButton MatcDropDownButton MatcDropDownSelect"},[s("div",{ref:"button",staticClass:"MatcDropDownButtonCntr",attrs:{type:"button"}},[t.icon?s("QIcon",{attrs:{icon:t.icon}}):t._e(),s("label",{staticClass:"MatcDropDownLabel",attrs:{"data-dojo-attach-point":"label"}}),s("span",{staticClass:"caret"})],1),t._m(0)])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDropDownPopUp ",attrs:{role:"menu","data-dojo-attach-point":"popup"}},[s("ul",{attrs:{role:"menu","data-dojo-attach-point":"ul"}})])}],n=s(26978),o=s(65454),r=s(42477),l=s(93134),c=s(24615),h=s(4623),d={name:"DropDownSelect",mixins:[n.Z],data:function(){return{icon:"",openCSS:"MatcDropDownButtonOpen",iconCSS:"MatcDropDownIcon",labelCSS:"MatcDropDownLabel",selectedCSS:"MatcDropDownButtonSelected",liCSS:"MatcDropDownMenuItem",updateLabel:!1,selected:{}}},methods:{renderOptions:function(t){for(var e=0;e<t.length;e++){var s=t[e],a=document.createElement("li");if(l.Z.add(a,this.liCSS),s.check){var i=document.createElement("span");l.Z.add(i,"MatcDropDownSelectCheck"),a.appendChild(i);var n=this.$new(o.Z);n.setValue(s.selected),n.setLabel(s.label),n.placeAt(i),n.on("change",r.Z.hitch(this,"onSelect",s)),this._lis[s.value]=a,this.selected[s.value]=s.selected}else if(s.label||s.icon){if(this.hasObjects=!0,s.icon){var d=document.createElement("span");l.Z.add(d,this.iconCSS),l.Z.add(d,s.icon),a.appendChild(d)}if(s.label){var u=document.createElement("label");l.Z.add(u,this.labelCSS),u.innerHTML=s.label,a.appendChild(u)}this.own((0,c.Z)(a,h.Z.press,r.Z.hitch(this,"onClick",s))),this._lis[s.value]=a}s.css&&l.Z.add(a,s.css),this.ul.appendChild(a)}},onSelect:function(t,e){t.callback?t.callback(e):(this.selected[t.value]=e,this.$emit("select",this.selected))},onClick:function(t,e){t.event&&this.$emit(t.event,e)}},watch:{}},u=d,f=s(1001),p=(0,f.Z)(u,a,i,!1,null,null,null),b=p.exports},30529:function(t,e,s){s.d(e,{Z:function(){return G}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDistributionSection"},[s("div",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("h3",{staticClass:"title level-item"},[s("span",[t._v(t._s(t.$t("analytics.distribution.title")))]),s("HelpButton",{attrs:{topic:"analytics.dist",hasNotifications:!1}})],1)]),s("div",{staticClass:"level-right level-options"},[t.hasConfig?s("CheckBox",{attrs:{value:!1,label:"zScore"},on:{change:t.onChangeNorm}}):t._e(),t.hasConfig?s("DropDownButton",{attrs:{value:t.clusterAlgo,options:t.clusterAlgoOptions},on:{change:t.onChangeAlgo}}):t._e(),t.hasConfig?s("DropDownSelect",{ref:"dropDown",attrs:{options:t.clusterOptions,l:t.$t("analytics.distribution.cluster-vars")},on:{select:t.onChangeCluster,algo:t.onChangeAlgo}}):t._e()],1)]),s("div",{staticClass:"MatcSurveySectionTableCntr"},[t.events&&t.events.length>0?["Scatter"===t.viewMode?s("ScatterPlot",{attrs:{yAxis:t.yAxis,xAxis:t.xAxis,app:t.app,pub:t.pub,clusterVars:t.clusterVars,clusterAlgo:t.clusterAlgo,clusterNorm:t.clusterNorm,events:t.events,annotation:t.annotation,test:t.test}}):t._e()]:s("span",{staticClass:"MatcHint"},[t._v(" "+t._s(t.$t("analytics.distribution.no-data"))+" ")])],2)])},i=[],n=(s(41539),s(54747),s(47941),s(74916),s(23123),s(14285)),o=s(89720),r=s(65454),l=s(10785),c=s(76500),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcScatterPlot MatcScatterPlot"+t.mode},[s("div",{staticClass:"MatcScatterPlotfActionCntr",attrs:{"data-dojo-attach-point":"actionCntr"}}),s("div",{staticClass:"MatcScatterPlotCntr",attrs:{"data-dojo-attach-point":"cntr"},on:{click:t.onBackgroundClick}},[s("span",{staticClass:"MatxAxisXLine MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden",attrs:{"data-dojo-attach-point":"xLine"}}),s("span",{staticClass:"MatxAxisYLine MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden",attrs:{"data-dojo-attach-point":"yLine"}}),s("div",{staticClass:"MatcScatterPlotCanvas",attrs:{"data-dojo-attach-point":"canvas"}}),s("span",{staticClass:"MatxAxisLabel xMaxLabel",attrs:{"data-dojo-attach-point":"xMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotDropOffHidden yMaxLabel",attrs:{"data-dojo-attach-point":"yMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden xMiddleLabel",attrs:{"data-dojo-attach-point":"xMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden yMiddleLabel",attrs:{"data-dojo-attach-point":"yMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel minLabel",attrs:{"data-dojo-attach-point":"minLabel"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel xLabel ",attrs:{"data-dojo-attach-point":"xLabel"}},[t._v("X")]),s("span",{staticClass:"MatxAxisLabel yLabel MatcScatterPlotDropOffHidden",attrs:{"data-dojo-attach-point":"yLabel"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yLabelEast"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yMinLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yMinLabelEast"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel yMaxLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yMaxLabelEast"}},[t._v("100")]),s("span",{staticClass:"MatxAxisLabel yMinLabel",attrs:{"data-dojo-attach-point":"yMinLabel"}}),s("span",{staticClass:"MatxAxisLabel bottom25Label MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom25Label"}}),s("span",{staticClass:"MatxAxisLabel bottom75Label MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom75Label"}}),s("span",{staticClass:"MatxAxisLabel MatxAxisLabelCntr",attrs:{"data-dojo-attach-point":"xAxisLabelCntr"}}),s("div",{staticClass:"MatcScatterPlotfTaskCntr",attrs:{"data-dojo-attach-point":"taskCntr"}},[s("div",{class:{MatcScatterPlotfTaskSelected:t.hasOutliers},on:{click:function(e){return t.toggleOutlier()}}},[s("span",{style:t.getOutlierStyle()}),s("label",[t._v(" "+t._s(t.getNLS("analytics.distribution.outlier")))])])]),t.hoverDetails?s("ScatterPlotDetails",{attrs:{value:t.hoverDetails}}):t._e()],1),s("div",{staticClass:"MatcScatterPlotHintBar",attrs:{"data-dojo-attach-point":"hintCntr"}})])},d=[],u=(s(57327),s(68309),s(77601),s(24615)),f=s(42477),p=s(93134),b=s(27519),v=s(55887),m=s(37339),g=s(21200),M=s(77907),L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcScatterPlotDetails "+t.value.cls,style:"bottom: "+t.value.y+"%; left:"+t.value.x+"%"},[s("span",{staticClass:"MatcScatterPlotDetailsArrow"}),s("div",{staticClass:"MatcScatterPlotDetailsContainer"},[s("table",[s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.duration"))+": ")]),s("td",[t._v(" "+t._s(Math.round(t.value.s.duration/1e3))+" s ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.interactions"))+": ")]),s("td",[t._v(" "+t._s(t.value.s.interactions)+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.screens"))+" : ")]),s("td",[t._v(" "+t._s(t.value.s.screenUnique)+" / "+t._s(t.value.s.screenLoads)+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.weirdness"))+" : ")]),s("td",[t._v(" "+t._s(Math.round(100*t.value.s.weirdness))+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.tasks"))+": ")]),s("td",[s("div",{staticClass:"MatcScatterPlotDetailsTaskCntr"},t._l(t.value.tasks,(function(e){return s("span",{key:e,staticClass:"MatcScatterPlotDetailsTask"},[t._v(" "+t._s(e)+" ")])})),0)])])])])])},k=[],x=s(99917),S={name:"ScatterPlotDetails",mixins:[x.Z],props:["value"],data:function(){return{}},components:{},methods:{},watch:{},mounted:function(){}},T=S,C=s(1001),_=(0,C.Z)(T,L,k,!1,null,null,null),y=_.exports,w=s(906),D=s(77161),P=s(19519),Z={name:"ScatterPlot",mixins:[b.Z,m.Z],props:["test","app","events","annotation","pub","mode","yAxis","xAxis","clusterVars","clusterAlgo","clusterNorm"],data:function(){return{tasks:[],selectedTasks:{},hasOutliers:!0,paddingFactor:1.1,dialog:!1,includeDropOff:!1,defaultColor:"#56A9FC",outlierColor:"#f83a3a",clusters:[],colors:["#9933cc","#669900","#ff8a00","#cc0000","#000000","#8ad5f0","#d6adeb","#c5e26d"],bins:3,hoverDetails:null}},components:{ScatterPlotDetails:y},methods:{getOutlierStyle:function(){return this.hasOutliers?"background:".concat(this.outlierColor,"; border:none"):""},getTaskStyle:function(t){return this.selectedTasks[t.id]?"background:".concat(t.color,"; border:none"):""},postCreate:function(){this.init(),this._scatterPoints={}},init:function(){this.db=new v.Z,this._scatterPoints={}},setValue:function(t,e,s,a){this.logger.log(-1,"setValue","enter"),D.Z.start("ScatterPlot.setValue()"),this.annotations=a,this.model=e;try{var i=this.filterEvents(s,a);this.df=this.getActionEvents(new M.Z(i)),this.df.sortBy("time"),this.tasks=f.Z.clone(t.tasks).filter((function(t){return t.flow.length>=2})),this.sessionDetails=this.analytics.getSessionDetails(this.df,this.tasks),this.sessionDetails=w.fZ(this.sessionDetails,this.df);var n=this.analytics.convertSessionDetails(this.sessionDetails);n.length<200?this.clusters=w.ki(n,this.clusterVars,this.clusterNorm,this.clusterAlgo):(this.logger.error("setValue","Too many events"),this.hasOutliers=!1),this.render()}catch(o){this.logger.error("setValue","Error"),this.logger.sendError(o)}D.Z.end("ScatterPlot.setValue()")},clickTask:function(t){this.selectTask(t),this.render(),this.$forceUpdate()},toggleOutlier:function(){this.hasOutliers=!this.hasOutliers,this.render(),this.$forceUpdate()},selectTask:function(t){for(var e in this.selectedTasks[null===t||void 0===t?void 0:t.id]=!this.selectedTasks[null===t||void 0===t?void 0:t.id],this.selectedTasks)e!==(null===t||void 0===t?void 0:t.id)&&(this.selectedTasks[e]=!1)},render:function(){this.logger.log(-1,"render","enter > "),this.cleanUpTempListener(),this.onBackgroundClick(),this.render_Scatter()},onBackgroundClick:function(){this.setHint(this.db.span("",this.getNLS("analytics.distribution.hint")).build()),this.unSelectPoint()},render_Scatter:function(){this.logger.log(1,"render_Scatter","enter",this.mode),delete this._selectedScatterPoint,this.xLabel.innerHTML=this.getNLS("analytics.distribution.details."+this.xAxis),this.yLabel.innerHTML=this.getNLS("analytics.distribution.details."+this.yAxis),this.minLabel.innerHTML="0 s",this.yMinLabel.innerHTML="0",this.render_Scatter_Points(this.xAxis,this.yAxis)},render_Scatter_Points:function(t,e){this.logger.log(1,"render_Scatter_Points","enter > "+t+" X "+e);var s=this.sessionDetails,a=Math.max(1,Math.ceil(s.max(t)*this.paddingFactor)),i=Math.max(1,Math.ceil(s.max(e)*this.paddingFactor)),n=s.mean(t),o=s.mean(e);this.xMaxLabel.innerHTML=Math.ceil(a/1e3)+" s",this.yMaxLabel.innerHTML=Math.ceil(i);for(var r=s.data,l=0;l<r.length;l++){var c=r[l],h=c[t],d=c[e];this.renderScatterPoint(l,c,h,d,a,i)}this.maxYAxis=i,this.maxXAxis=a,this.meanYAxis=o,this.meanXAxis=n,this.unSelectPoint()},renderScatterPoint:function(t,e,s,a,i,n){var o=e.session,r=Math.min(10*t,300);if(!this._scatterPoints[o]){var l=this.db.span("MatxScatterPoint").build(this.canvas);l.style.bottom="-5%",l.style.left=s/i*100+"%",this._scatterPoints[o]=l}var c=this.getPointColor(e,t),h=this._scatterPoints[o];h.style.background=c,this.tempOwn((0,u.Z)(h,"click",f.Z.hitch(this,"selectPoint",h,e,s,a,t))),this.tempOwn((0,u.Z)(h,"mouseover",f.Z.hitch(this,"hoverPoint",h,e,s,a,t))),this.tempOwn((0,u.Z)(h,"mouseout",f.Z.hitch(this,"leavePoint"))),setTimeout(f.Z.hitch(this,"animateScatterPoint",h,s,a,i,n),r)},animateScatterPoint:function(t,e,s,a,i){t.style.bottom=s/i*100+"%",t.style.left=e/a*100+"%"},unSelectPoint:function(){setTimeout(f.Z.hitch(this,"setMiddle",this.meanYAxis,this.maxYAxis,this.meanXAxis,this.maxXAxis),200)},getPointColor:function(t,e){if(-1===this.clusters[e]&&this.hasOutliers)return this.outlierColor;for(var s in this.selectedTasks)if(this.selectedTasks[s]&&t[s]&&t[s].success)return this.taskColors[s];return this.defaultColor},hoverPoint:function(t,e,s,a){var i=100*s/this.maxXAxis,n=100*a/this.maxYAxis,o="";o+=i>50?"left ":"right ",o+=n>50?"bottom ":"top ";var r=[];this.tasks.forEach((function(t){var s;1===(null===(s=e[t.id])||void 0===s?void 0:s.success)&&r.push(t.name)})),this.hoverDetails={x:i,y:n,cls:o,s:e,tasks:r}},leavePoint:function(){this.hoverDetails=null},selectPoint:function(t,e,s,a,i,n){this.stopEvent(n),this.setXMiddle(s,this.maxXAxis),this.setYMiddle(a,this.maxYAxis),p.Z.add(this.cntr,"MatcScatterPlotCntrHover"),this._selectedScatterPoint=t,this.showSessionReplayHint(e.session)},showSessionReplayHint:function(t){if(this.model){var e="#/apps/"+this.model.id+"/replay/"+t+".html";"public"==this.mode&&(e="#/examples/"+this.model.id+"/replay/"+t+".html");var s=this.db.span("").build();this.db.span("",this.getNLS("analytics.distribution.play")).build(s);var a=this.db.a("",this.getNLS("analytics.distribution.here")).build(s);a.href=e,a.target="_matcSessionReplay"+t,this.setHint(s)}},setHint:function(t){this.hintCntr.innerHTML="",t&&(this.hintCntr.appendChild((0,P.Xl)("PlayVideo")),this.hintCntr.appendChild(t))},clearPoint:function(){p.Z.remove(this.cntr,"MatcScatterPlotCntrHover")},setMiddle:function(t,e,s,a){this.setXMiddle(s,a),this.setYMiddle(t,e),p.Z.remove(this.cntr,"MatcScatterPlotCntrHover")},setYMiddle:function(t,e){this.yMiddleLabel.innerHTML=Math.ceil(t),this.yMiddleLabel.style.bottom=t/e*100+"%",this.yLine.style.bottom=t/e*100+"%"},setXMiddle:function(t,e){this.xMiddleLabel.innerHTML=Math.ceil(t/1e3)+" s",this.xMiddleLabel.style.left=t/e*100+"%",this.xLine.style.left=t/e*100+"%"}},watch:{mode:function(t){this.mode=t,this.render()},yAxis:function(t){this.yAxis=t,this.render()},xAxis:function(t){this.xAxis=t,this.render()},clusterVars:function(t){this.clusterVars=t,this.setValue(this.test,this.app,this.events,this.annotation)},clusterAlgo:function(t){this.clusterAlgo=t,this.setValue(this.test,this.app,this.events,this.annotation)},clusterNorm:function(t){this.clusterNorm=t,this.setValue(this.test,this.app,this.events,this.annotation)}},mounted:function(){this.analytics=new g.Z,this.logger=new n.Z("ScatterPlot"),this.db=new v.Z,this.setValue(this.test,this.app,this.events,this.annotation)}},H=Z,A=(0,C.Z)(H,h,d,!1,null,null,null),N=A.exports,E={name:"DistributionSection",mixins:[],props:["test","app","events","annotation","pub"],data:function(){return{xAxis:"duration",yAxis:"interactions",hasOutlier:!1,hasConfig:!1,isLoaded:!1,scatterMode:"duration,interactions",viewMode:"Scatter",viewOptions:[{value:"Scatter",label:this.$t("analytics.distribution.viewScatter"),event:"scatter"},{value:"Details",label:this.$t("analytics.distribution.viewDetails"),event:"outlier"},{value:"Outlier",label:this.$t("analytics.distribution.viewOutlier"),event:"outlier"}],selection:[],cols:[{key:"interactions",label:"Interactions"},{key:"duration",label:"Duration"},{key:"screens",label:"Test Coverage"},{key:"tasks",label:"Tasks"},{key:"outlierRaw",label:"Outlier Raw"},{key:"outlierUmap",label:"Outlier Umap"}],clusterAlgoOptions:[{value:"optics",label:"Optics"},{value:"dbscan",label:"DBScan"},{value:"lof",label:" LOF"}],clusterOptions:[{value:"duration",label:this.$t("analytics.distribution.details.duration"),check:!0,selected:!0},{value:"interactions",label:this.$t("analytics.distribution.details.interactions"),check:!0,selected:!0},{value:"screenLoads",label:this.$t("analytics.distribution.details.screenLoads"),check:!0,selected:!0},{value:"screenRatio",label:this.$t("analytics.distribution.details.screenRatio"),check:!0,selected:!1},{value:"tasks",label:this.$t("analytics.distribution.details.tasks"),check:!0,selected:!0},{value:"weirdness",label:this.$t("analytics.distribution.details.weirdness"),check:!0,selected:!1}],clusterAlgo:"optics",clusterNorm:"minmax",clusterVars:["interactions","duration","screenLoads","tasks"]}},components:{HelpButton:c.Z,DropDownSelect:l.Z,DropDownButton:o.Z,ScatterPlot:N,CheckBox:r.Z},computed:{},methods:{onChangeNorm:function(t){this.clusterNorm=t?"zScore":"minmax"},onChangeAlgo:function(t){this.clusterAlgo=t},onChangeCluster:function(t){var e=[];Object.keys(t).forEach((function(s){var a=t[s];a&&e.push(s)})),this.clusterVars=e},setScatterMode:function(t){if(t){var e=t.split(",");this.xAxis=e[0],this.yAxis=e[1]}this.scatterMode=t},setViewMode:function(t){this.viewMode=t,this.selection=[]},showSelection:function(t){this.selection=t}},mounted:function(){this.logger=new n.Z("DistributionSection"),this.isLoaded=!0}},B=E,V=(0,C.Z)(B,a,i,!1,null,null,null),G=V.exports},96529:function(t,e,s){s.d(e,{Z:function(){return M}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcDialog TaskCreateDialog "+t.model.type},[s("div",{staticClass:"TaskCreateDialogCntr"},[s("div",{staticClass:"FormCntr"},[s("div",{staticClass:"form-group"},[s("label",[t._v("Name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.task.name,expression:"task.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Name"},domProps:{value:t.task.name},on:{input:function(e){e.target.composing||t.$set(t.task,"name",e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",[t._v("Description")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.task.description,expression:"task.description"}],staticClass:"form-control",attrs:{type:"text",placeholder:"An explaination for the users"},domProps:{value:t.task.description},on:{input:function(e){e.target.composing||t.$set(t.task,"description",e.target.value)}}})]),s("div",[s("label",[t._v("Expected Steps")]),s("p",{staticClass:"MatcHint mb-16"},[t._v("Click in the simulator to add steps. You can remove steps that are not needed by clicking on them.")]),s("div",{staticClass:"StepCntr form-group"},t._l(t.steps,(function(e,a){return s("div",{key:a,staticClass:"Step"},[a>0?s("span",{staticClass:"mdi mdi-arrow-right"}):t._e(),s("div",{staticClass:"StepDetails"},[t._v(" "+t._s(e.type)+" - "+t._s(e.label)+" "),s("div",{staticClass:"removePopup",on:{click:function(e){return t.removeEvent(a)}}},[s("span",{staticClass:"mdi"},[t._v("Remove")])])])])})),0),s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{label:"Strict matching. No events between are allowed.",value:t.task.strict},on:{change:t.setStrict}})],1),s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{label:"Record only screen views",value:t.recordOnlyScreenViews},on:{change:t.setRecordOnlyScreenView}})],1)])]),s("div",{ref:"simCntr",staticClass:"SimCntr"},[s("div",{ref:"wrapper",staticClass:"SimWrapper"}),t.abScreens&&t.abScreens.length>0?s("div",{staticClass:"ABSelector"},[s("p",{staticClass:"MatcHint"},[t._v(" Select the next screen to show ")]),t._l(t.abScreens,(function(e){return s("div",{key:e.id,staticClass:"MatcButton",on:{click:function(s){return t.selectABLine(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2):t._e()])]),s("div",{staticClass:"MatcButtonBar"},[s("a",{staticClass:"MatcButton MatcButtonPrimary",on:{click:t.onSave}},[t._v("Save")]),s("a",{staticClass:"MatcLinkButton",on:{click:t.onCancel}},[t._v("Cancel")])])])},i=[],n=s(50124),o=s(48534),r=(s(21249),s(69826),s(41539),s(40561),s(2707),s(99917)),l=s(42477),c=s(24615),h=s(14285),d=s(65454),u=s(90716),f=s(37339),p=s(40626),b={name:"TaskCreateDialog",props:["model"],mixins:[f.Z,r.Z],data:function(){return{hash:"NoHashTaskCreate",recordOnlyScreenViews:!0,abScreens:null,ignoreFirstEvent:!1,task:{name:"",description:"",flow:[]},ignoredEvents:["SessionStart","ScreenAnimation","Animation","OverlayRemoveAnimation","OverlayShowAnimation","MouseOut","MouseOver","WidgetInit","ValidationOK"]}},components:{CheckBox:d.Z},computed:{steps:function(){var t=this;return this.task.flow.map((function(e){return{screen:t.getScreenName(e.screen),widget:t.getWidgetName(e.widget),type:t.getEventLabelWithState(e),label:e.widget?t.getWidgetName(e.widget)+" @ "+t.getScreenName(e.screen):t.getScreenName(e.screen)}}))}},methods:{getEventLabelWithState:function(t){return!t.state||"WidgetClick"!==t.type&&"WidgetChange"!==t.type?this.getEventLabel(t.type):this.getEventStateLabel(t.state)},setRecordOnlyScreenView:function(t){this.recordOnlyScreenViews=t},postCreate:function(){var t=this;this.logger=new h.Z("TaskCreateDialog"),this.logger.log(-1,"postCreate","enter > "+this.appID+"> "+this.hash),setTimeout((function(){t.createSimulator()}),500)},createSimulator:function(){var t=this,e=this.$refs.wrapper,s=this.resizeSimulatorContainer(this.model,this.$refs.simCntr,.7);e.style.width=s.w+"px",e.style.height=s.h+"px",this.simulator=this.$new(u.Z,{isDesktopTest:!0,mode:"recordFlow",logData:!1}),this.simulator.setHash(this.hash),this.tempOwn((0,c.Z)(this.simulator,"event",l.Z.hitch(this,"onEvent"))),this.simulator.placeAt(e),this.simulator.scrollListenTarget="parent",this.simulator.startup(),this.simulator.abSelector=function(e,s){t.showABDialog(e,s)},this.simulator.setModel(this.model)},showABDialog:function(t,e){var s=this;return(0,o.Z)((0,n.Z)().mark((function a(){return(0,n.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s.logger.log(-1,"showABDialog","enter > ",t),s.abCallback=e,s.abLines=t,s.abScreens=t.map((function(t){var e=t.to;return s.model.screens[e]?s.model.screens[e]:s.model.widgets[e]?s.model.widgets[e]:void 0}));case 4:case"end":return a.stop()}}),a)})))()},selectABLine:function(t){if(this.logger.log(-1,"selectABLine","enter > ",t),this.abLines&&this.abCallback){var e=this.abLines.find((function(e){return e.to===t.id}));this.abCallback(e)}this.abLines=null,this.abScreens=null,this.abCallback=null},resizeSimulatorContainer:function(t,e){var s=p.Z.position(e);return s.h=600,"smartphone"==t.type?t.screenSize.h<t.screenSize.w?(this.logger.log(-1,"resizeSimulatorContainer","Wide screen"),s=this.getScaledSize(s,"width",t)):s=this.getScaledSize(s,"height",t):s=this.getScaledSize(s,"width",t),s},onEvent:function(t){if(this.logger.log(-1,"onEvent","enter > ignoreFirstEvent:"+this.ignoreFirstEvent,t),this.recordOnlyScreenViews){if("ScreenLoaded"===t.type||"OverlayLoaded"===t.type){if(this.ignoreFirstEvent)return this.logger.log(-1,"onEvent","ignore first event"),void(this.ignoreFirstEvent=!1);this.task.flow.push({screen:t.screen,widget:t.widget,type:t.type,state:t.state})}}else if(this.ignoredEvents.indexOf(t.type)<0){if(this.ignoreFirstEvent)return this.logger.log(-1,"onEvent","ignore first event"),void(this.ignoreFirstEvent=!1);this.task.flow.push({screen:t.screen,widget:t.widget,type:t.type,state:t.state})}},removeEvent:function(t){this.task.flow.splice(t,1)},setStrict:function(t){this.task.strict=t},onCancel:function(){this.emit("close",{})},onSave:function(){this.task.flow.sort((function(t,e){return t.time-e.time})),this.emit("save",this.task)},getValue:function(){return this.task},setValue:function(t){this.task=l.Z.clone(t)},cleanUp:function(){this.cleanUpTempListener()}},mounted:function(){}},v=b,m=s(1001),g=(0,m.Z)(v,a,i,!1,null,null,null),M=g.exports},43285:function(t,e,s){s.d(e,{Z:function(){return x}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDashTaskPerfGram"},[t._m(0),s("div",{staticClass:"MatcDashTaskPerfActionCntr",attrs:{"data-dojo-attach-point":"actionCntr"}}),s("div",{staticClass:"MatcDashTaskPerfGramCntr",attrs:{"data-dojo-attach-point":"cntr"}},[s("span",{staticClass:"MatxAxisXLine MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden",attrs:{"data-dojo-attach-point":"xLine"}}),s("span",{staticClass:"MatxAxisYLine MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden",attrs:{"data-dojo-attach-point":"yLine"}}),s("div",{staticClass:"MatcDashTaskPerfGramCanvas",attrs:{"data-dojo-attach-point":"canvas"}}),s("span",{staticClass:"MatxAxisLabel xMaxLabel",attrs:{"data-dojo-attach-point":"xMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfGramDropOffHidden yMaxLabel",attrs:{"data-dojo-attach-point":"yMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden xMiddleLabel",attrs:{"data-dojo-attach-point":"xMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden yMiddleLabel",attrs:{"data-dojo-attach-point":"yMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel minLabel",attrs:{"data-dojo-attach-point":"minLabel"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel xLabel ",attrs:{"data-dojo-attach-point":"xLabel"}},[t._v("X")]),s("span",{staticClass:"MatxAxisLabel yLabel MatcDashTaskPerfGramDropOffHidden",attrs:{"data-dojo-attach-point":"yLabel"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yLabelEast"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yMinLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yMinLabelEast"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel yMaxLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yMaxLabelEast"}},[t._v("100")]),s("span",{staticClass:"MatxAxisLabel yMinLabel",attrs:{"data-dojo-attach-point":"yMinLabel"}}),s("span",{staticClass:"MatxAxisLabel bottom25Label MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom25Label"}}),s("span",{staticClass:"MatxAxisLabel bottom75Label MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom75Label"}}),s("span",{staticClass:"MatxAxisLabel MatxAxisLabelCntr",attrs:{"data-dojo-attach-point":"xAxisLabelCntr"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasTaskSelector,expression:"hasTaskSelector"}],staticClass:"MatcDashTaskPerfTaskCntr",attrs:{"data-dojo-attach-point":"taskCntr"}}),s("div",{staticClass:"MatcDashTaskPerfDropCntr",attrs:{"data-dojo-attach-point":"dropoffCntr"}},[s("CheckBox",{attrs:{label:"Show Dropoff"},on:{change:t.onChangeFunnelDropOff}})],1)]),s("div",{staticClass:"MatcDashTaskPerHintBar",attrs:{"data-dojo-attach-point":"hintCntr"}})])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcToolbarTabContainer"},[s("div",{staticClass:"MatcToolbarTabs",attrs:{"data-dojo-attach-point":"tabsCntr"}})])}],n=(s(68309),s(41539),s(54747),s(2707),s(99917)),o=s(24615),r=s(42477),l=s(93134),c=s(14285),h=s(27519),d=s(55887),u=s(65454),f=s(37339),p=s(21200),b=s(69912),v=s(77907),m=s(19519),g={name:"TaskPerfGram",mixins:[h.Z,f.Z,n.Z],data:function(){return{x_prefix:"",paddingFactor:1.1,tab:"scatter",tabs:{},dialog:!1,includeDropOff:!1,colors:["#56A9FC","#9933cc","#669900","#ff8a00","#cc0000","#000000","#8ad5f0","#d6adeb","#c5e26d"],bins:3,smoothLineFunction:b.jvg().curve(b.$0Z).x((function(t){return t.x-.5})).y((function(t){return t.y-.5})),straightLineFunction:b.jvg().x((function(t){return t.x-.5})).y((function(t){return t.y-.5})),canvasPos:{w:800,h:450},hasTaskSelector:!0}},components:{CheckBox:u.Z},methods:{postCreate:function(){this.log=new c.Z("TaskPerfGram"),this.init(),this._scatterPoints={}},init:function(){this.db=new d.Z,this.addTab("scatter","MatcToolbarTabActive"),this.addTab("details",""),this.addTab("funnelDurartion",""),this.addTab("funnelInteraction",""),this._scatterPoints={}},addTab:function(t,e){var s=this.db.a(e,this.getNLS("dash.perf.tab."+t)).build(this.tabsCntr);this.own((0,o.Z)(s,"mousedown",r.Z.hitch(this,"setTab",t))),this.tabs[t]=s},setTab:function(t){if(this.tab!=t){for(var e in this.lastTab=this.tab,this.tab=t,this.tabs)l.Z.remove(this.tabs[e],"MatcToolbarTabActive");this.tabs[t]&&l.Z.add(this.tabs[t],"MatcToolbarTabActive"),this.render()}},setModel:function(t){this.model=t},setValue:function(t,e,s,a){this.df=t,this.task=e,this.annotations=s,this.tasks=a,this.renderTasks(a),this.selectTask(e),this.render()},renderTasks:function(t){this.log.log(-1,"renderTasks","enter"),this.taskDivs={},this.taskCircles={},this.selectedTasks={},this.taskColors={};for(var e=0;e<t.length;e++){var s=t[e];if(s.flow.length>=2){this.selectedTasks[s.id]=!1,this.taskColors[s.id]=this.colors[e%this.colors.length];var a=this.db.div().build(this.taskCntr),i=this.db.span("").build(a);this.db.label("",t[e].name).build(a),this.taskCircles[s.id]=i,this.taskDivs[s.id]=a,this.own((0,o.Z)(a,"click",r.Z.hitch(this,"clickTask",s,e)))}}},clickTask:function(t){this.selectTask(t),this.render(!0)},selectTask:function(t){for(var e in this.selectedTasks[t.id]=!this.selectedTasks[t.id],this.selectedTasks){var s=this.taskCircles[e],a=this.taskDivs[e];a&&s&&(this.selectedTasks[e]?(l.Z.add(a,"MatcDashTaskPerfTaskSelected"),s.style.background=this.taskColors[e]):(l.Z.remove(a,"MatcDashTaskPerfTaskSelected"),s.style.background=""))}},render:function(t){this.log.log(-1,"render","enter > "+t),this.cleanUpTempListener(),this.task.flow&&this.task.flow.length>=2?!t&&this["clean_"+this.lastTab]?this["clean_"+this.lastTab](r.Z.hitch(this,"renderTab",t)):this.renderTab(t):(l.Z.add(this.tabsCntr,"hidden"),l.Z.add(this.cntr,"hidden"),this.db.h2("",this.getNLS("dash.perf.no-flow-title")).build(this.domNode),this.db.div("MatcMarginTop",this.getNLS("dash.perf.no-flow-msg"),!0).build(this.domNode))},renderTab:function(t){"dropoff"===this.tab||"funnelDurartion"===this.tab||"funnelInteraction"===this.tab?l.Z.add(this.domNode,"MatcDashTaskPerfGramHideTasks"):l.Z.remove(this.domNode,"MatcDashTaskPerfGramHideTasks"),"funnelDurartion"===this.tab||"funnelInteraction"===this.tab?l.Z.remove(this.domNode,"MatcDashTaskPerfGramHideDropoff"):l.Z.add(this.domNode,"MatcDashTaskPerfGramHideDropoff"),this["render_"+this.tab]?this["render_"+this.tab](this.df,this.task,this.annotations,this.tasks,t):this.log.error("render","No render for "+this.tab)},onChangeFunnelDropOff:function(t){this.log.log(-1,"onChangeFunnelDropOff","enter > :",this.tab),this.includeDropOff=t,"funnelDurartion"===this.tab&&(this.clean_funnelDurartion(),this.render_funnelDurartion(this.df,this.task,!0)),"funnelInteraction"===this.tab&&(this.clean_funnelInteraction(),this.render_funnelInteraction(this.df,this.task,!0))},render_funnelInteraction:function(t,e){var s=this;this.log.log(-1,"render_funnelInteractions","enter > :",this.includeDropOff),l.Z.add(this.domNode,"MatcDashTaskPerfGramFunnel"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML="",this.bottom75Label.innerHTML="",this.xMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMinLabelEast.innerHTML="",this.minLabel.innerHTML="",this.yMinLabel.innerHTML="0";var a=60,i=e.flow,n=(this.canvasPos.w-2*a)/(i.length-1),r=this.canvasPos.h-20,c=new p.Z,h=c.getFunnelInteraction(t,e,this.includeDropOff),d=c.getFunnelMax(h)+1;this._render_funnel_steps(h,d,i,n,a,r),this._render_funnel_lines(h,d,n,a,r,(function(t){return Math.round(t)})),this.yMaxLabel.innerHTML=d,this.tempOwn((0,o.Z)(this.cntr,"click",(function(){return s.reset_funnel_selection()})))},clean_funnelInteraction:function(t){this.log.log(-1,"clean_funnelInteractions","enter > :"),l.Z.remove(this.domNode,"MatcDashTaskPerfGramFunnel"),this._stepDivs&&(this._stepDivs.forEach((function(t){t.parentNode.removeChild(t)})),delete this._stepDivs),this.funnelSVG&&(this.canvas.innerHTML="",delete this.funnelSVG),this.xAxisLabelCntr.innerHTML="",this.yMinLabel.innerHTML="",t&&t()},render_funnelDurartion:function(t,e){var s=this;this.log.log(-1,"render_funnelDurartion","enter > :"),l.Z.add(this.domNode,"MatcDashTaskPerfGramFunnel"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML="",this.bottom75Label.innerHTML="",this.xMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMinLabelEast.innerHTML="",this.minLabel.innerHTML="",this.yMinLabel.innerHTML="0";var a=60,i=e.flow,n=(this.canvasPos.w-2*a)/(i.length-1),r=this.canvasPos.h-20,c=new p.Z,h=c.getFunnelDuration(t,e,this.includeDropOff),d=c.getFunnelMax(h)+1e3;this._render_funnel_steps(h,d,i,n,a,r),this._render_funnel_lines(h,d,n,a,r,(function(t){return Math.round(t/100)/10+" s"})),this.yMaxLabel.innerHTML=Math.ceil(d/1e3)+" s",this.tempOwn((0,o.Z)(this.cntr,"click",(function(){return s.reset_funnel_selection()})))},reset_funnel_selection:function(){this.selectFunnelPoint(!1),this.setHint()},_render_funnel_lines:function(t,e,s,a,i,n){var o=this.db.div("MatcDashTaskPerfGramFunnelSVG MatcDashTaskPerfGramFunnelSVGHidden").build(this.canvas);for(var r in this.funnelSVG=b.Ys(o).append("svg").attr("width",this.canvasPos.w).attr("height",this.canvasPos.h),this.lineSVGs={},this.lineColor={},this.linePoints={},t){var c=t[r];this._render_funnel_session_line(r,c,e,s,i,a,n)}setTimeout((function(){l.Z.remove(o,"MatcDashTaskPerfGramFunnelSVGHidden")}),200)},_render_funnel_session_line:function(t,e,s,a,i,n,l){var c=this,h=Math.round(a/4),d=[],u=this.colors[0];this.linePoints[t]=[],e.forEach((function(f,p){u=!0===f.dropoff?"red":c.colors[0];var b={x:n+a*p,y:i-f.value/s*i},v=c.db.div("MatcDashTaskPerfGramFunnelStepPoint").left(b.x).top(b.y).build(c.canvas);c.db.div("MatcDashTaskPerfGramFunnelStepPointLabel",l(f.value)).build(v),v.style.background=u,c.tempOwn((0,o.Z)(v,"click",r.Z.hitch(c,"selectFunnelPoint",t))),c.linePoints[t].push(v),p>0&&d.push({x:b.x-h,y:b.y}),d.push(b),p<e.length-1&&d.push({x:b.x+h,y:b.y})}));var f=this.funnelSVG.append("path").attr("d",this.smoothLineFunction(d)).attr("stroke",u).attr("stroke-width",1).attr("fill","none").style("opacity",.5);this.lineSVGs[t]=f,this.lineColor[t]=u},_render_funnel_steps:function(t,e,s,a,i,n){var o=this;this._stepDivs=[],s.length>1&&s.forEach((function(r,c){var h=o.getStepData(t,c),d=new v.Z(h),u=Math.ceil(d.max("value")),f=Math.ceil(d.min("value")),p=Math.ceil(d.mean("value")),b=Math.ceil(d.std("value")),m=i+a*c,g=o.db.div("MatcDashTaskPerfGramFunnelStep MatcDashTaskPerfGramFunnelStepSmall").left(m).build(o.canvas);o.render_funnel_box_plot(g,-11,20,u,f,p,b,e,o.colors[0],n),o._stepDivs.push(g);var M=s.length<7?o.getNiceEventLabel(r,c,!1):"Step "+(c+1);o.db.div("MatcDashTaskPerfGramFunnelStepLabel",M).left(i+a*c).build(o.xAxisLabelCntr),setTimeout((function(){l.Z.remove(g,"MatcDashTaskPerfGramFunnelStepSmall")}),Math.min(300,50*c))}))},render_funnel_box_plot:function(t,e,s,a,i,n,o,r,l,c){var h=(a-i)/r*c,d=this.db.div("MatcDashTaskPerfGramBoxPlotCntr").top(c-a/r*c).h(h).w(s).left(e).build(t),u=this.db.div("MatcDashTaskPerfGramBoxPlot").build(d);u.style.bottom=100*Math.max(0,(n-o-i)/(a-i))+"%",u.style.height=2*o/(a-i)*100+"%",u.style.background=l;var f=this.db.div("MatcDashTaskPerfGramBoxPlotMean").build(d);f.style.bottom=(n-i)/(a-i)*100+"%"},getStepData:function(t,e){var s=[];for(var a in t){var i=t[a];void 0!==i[e]&&s.push(i[e])}return s},selectFunnelPoint:function(t,e){var s=this;this.log.log(-1,"selectFunnelPoint","enter > :",t),this.stopEvent(e),this.showSessionReplayHint(t);var a=function(e){var a=s.lineSVGs[e],i=e===t?s.colors[1]:s.lineColor[e];a&&a.attr("stroke",i),s.linePoints[e]&&s.linePoints[e].forEach((function(t){t.style.background=i}))};for(var i in this.lineSVGs)a(i)},clean_funnelDurartion:function(t){this.log.log(-1,"clean_funnelDurartion","enter > :"),l.Z.remove(this.domNode,"MatcDashTaskPerfGramFunnel"),this._stepDivs&&(this._stepDivs.forEach((function(t){t.parentNode.removeChild(t)})),delete this._stepDivs),this.funnelSVG&&(this.canvas.innerHTML="",delete this.funnelSVG),this.xAxisLabelCntr.innerHTML="",this.yMinLabel.innerHTML="",t&&t()},render_details:function(t,e,s,a){this.log.log(-1,"render_duration","enter > changeTask:"),l.Z.add(this.domNode,"MatcDashTaskPerfGramDetails"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML=this.getNLS("dash.perf.details.bottom25Label"),this.bottom75Label.innerHTML=this.getNLS("dash.perf.details.bottom75Label"),this.xMaxLabel.innerHTML="",this.yMinLabel.innerHTML="",this.minLabel.innerHTML="";var i=new p.Z,n=i.getTaskPerformance(t,a),o=1,r=1,c=0;for(var h in this.selectedTasks)if(this.selectedTasks[h]){var d=n.select("task","==",h);o=Math.max(o,Math.ceil(d.max("duration")*this.paddingFactor)),r=Math.max(r,Math.ceil(d.max("interactions")*this.paddingFactor)),c++}this.yMaxLabel.innerHTML=r,this.yMaxLabelEast.innerHTML=Math.ceil(o/1e3)+" s";var u=0,f=2,b=2*c-1;for(var v in this.selectedTasks)if(this.selectedTasks[v]){var m=n.select("task","==",v),g=Math.ceil(m.max("interactions")),M=Math.ceil(m.min("interactions")),L=Math.ceil(m.mean("interactions")),k=Math.ceil(m.std("interactions")),x=25-f*b/2+2*u*f+"%";this.createBoxPlot(v,"i",u,x,f,g,M,L,k,r,this.taskColors[v]),g=Math.ceil(m.max("duration")),M=Math.ceil(m.min("duration")),L=Math.ceil(m.mean("duration")),k=Math.ceil(m.std("duration")),x=75-f*b/2+2*u*f+"%",this.createBoxPlot(v,"d",u,x,f,g,M,L,k,o,this.taskColors[v]),u++}else if(this._bars){if(this._bars[v+"i"]){var S=this._bars[v+"i"];S.parentNode.removeChild(S),delete this._bars[v+"i"]}if(this._bars[v+"d"]){var T=this._bars[v+"d"];T.parentNode.removeChild(T),delete this._bars[v+"d"]}}},createBoxPlot:function(t,e,s,a,i,n,o,l,c,h,d){var u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"%";this._bars||(this._bars={});var f=(n-o)/h*100+"%",p=Math.min(60*s,500);if(this._bars[t+e]){var b=this._bars[t+e];b.style.left=a,setTimeout(r.Z.hitch(this,"animateBoxplot",b,f),p)}else{var v=this.db.div("MatcDashTaskPerfGramBoxPlotCntr").build(this.canvas);v.style.bottom=o/h*100+"%",v.style.left=a,v.style.height="0px",v.style.width=i+u,this.db.div("MatcDashTaskPerfGramBoxPlotLine").build(v);var m=this.db.div("MatcDashTaskPerfGramBoxPlot").build(v);m.style.bottom=100*Math.max(0,(l-c-o)/(n-o))+"%",m.style.height=2*c/(n-o)*100+"%",m.style.background=d;var g=this.db.div("MatcDashTaskPerfGramBoxPlotMean").build(v);g.style.bottom=(l-o)/(n-o)*100+"%",setTimeout(r.Z.hitch(this,"animateBoxplot",v,f),p),this._bars[t+e]=v}},animateBoxplot:function(t,e){t.style.height=e},clean_details:function(t){if(this.log.log(-1,"clean_duration","enter"),l.Z.remove(this.domNode,"MatcDashTaskPerfGramDetails"),this.setHint(),this._bars)for(var e in this._bars){var s=this._bars[e];s.style.height="0%",s.style.bottom="0%"}setTimeout(r.Z.hitch(this,"removeBoxplots"),200),t&&setTimeout(t,200)},removeBoxplots:function(){if(this._bars)for(var t in this._bars){var e=this._bars[t];this.canvas.removeChild(e)}delete this._bars},render_scatter:function(t,e,s,a,i){this.log.log(-1,"render_scatter","enter > changeTask:"+i);var n=new d.Z;delete this._selectedScatterPoint,this.setHint(n.span("",this.getNLS("dash.perf.hint.scatter")).build()),l.Z.add(this.domNode,"MatcDashTaskPerfGramScatter"),this.xLabel.innerHTML=this.getNLS("dash.perf.scatter.xLabel"),this.yLabel.innerHTML=this.getNLS("dash.perf.scatter.yLabel"),this.minLabel.innerHTML="0 s",this.yMinLabel.innerHTML="0";var c=new p.Z,h=c.getTaskPerformance(t,a),u=1,f=1,b=0,v=0,m=0;for(var g in this.selectedTasks)if(this.selectedTasks[g]){var M=h.select("task","==",g);u=Math.max(u,Math.ceil(M.max("duration")*this.paddingFactor)),f=Math.max(f,Math.ceil(M.max("interactions")*this.paddingFactor))}for(var L in this.xMaxLabel.innerHTML=Math.ceil(u/1e3)+" s",this.yMaxLabel.innerHTML=Math.ceil(f),this.selectedTasks){var k=h.select("task","==",L),x=k.data;if(x.sort((function(t,e){return e.interactions-t.interactions})),this.selectedTasks[L]){b=k.mean("duration"),v=k.mean("interactions");for(var S=0;S<x.length;S++){var T=x[S],C=T.session+" "+L,_=Math.min(10*S,300);if(m=Math.max(m,_),this._scatterPoints[C]){var y=this._scatterPoints[C];this.tempOwn((0,o.Z)(y,"click",r.Z.hitch(this,"selectPoint",y,T,S))),setTimeout(r.Z.hitch(this,"animateScatterPoint",y,T,u,f),_)}else{var w=n.span("MatxScatterPoint").build(this.canvas);w.style.bottom="-5%",w.style.left=T.duration/u*100+"%",w.style.background=this.taskColors[L],this._scatterPoints[C]=w,this.tempOwn((0,o.Z)(w,"click",r.Z.hitch(this,"selectPoint",w,T,S))),setTimeout(r.Z.hitch(this,"animateScatterPoint",w,T,u,f),_)}}}else for(var D=0;D<x.length;D++){var P=x[D],Z=P.session+" "+L;if(this._scatterPoints[Z]){var H=this._scatterPoints[Z];H.style.opacity=0,setTimeout(r.Z.hitch(this,"fadeOutPoint",H),300),delete this._scatterPoints[Z]}}}this.max_interactions=f,this.max_duration=u,setTimeout(r.Z.hitch(this,"setMiddle",v,f,b,u),200)},fadeOutPoint:function(t){t.parentNode&&t.parentNode.removeChild(t)},clean_scatter:function(t){if(this.log.log(-1,"clean_scatter","enter"),l.Z.remove(this.domNode,"MatcDashTaskPerfGramScatter"),this.setHint(),this._scatterPoints)for(var e in this._scatterPoints){var s=this._scatterPoints[e];s.style.bottom="-5%"}setTimeout(r.Z.hitch(this,"removePoints"),200),t&&setTimeout(t,200),this.yMinLabel.innerHTML="",this.minLabel.innerHTML=""},removePoints:function(){if(this._scatterPoints)for(var t in this._scatterPoints){var e=this._scatterPoints[t];e.parentNode&&e.parentNode.removeChild(e)}delete this._scatterPoints,this._scatterPoints={}},selectPoint:function(t,e,s,a){this.stopEvent(a),this.setXMiddle(e.duration,this.max_duration),this.setYMiddle(e.interactions,this.max_interactions),l.Z.add(this.cntr,"MatcDashTaskPerfGramCntrHover"),this._selectedScatterPoint=t,this.showSessionReplayHint(e.session)},showSessionReplayHint:function(t){if(this.model){var e="#/apps/"+this.model.id+"/replay/"+t+".html";"public"==this.mode&&(e="#/examples/"+this.model.id+"/replay/"+t+".html");var s=this.db.span("",this.getNLS("dash.perf.hint.session-msg")).build(),a=this.db.a("",this.getNLS("dash.perf.hint.session-play")).build(s);a.href=e,a.target="_matcSessionReplay"+t,this.setHint(s)}},render_dropoff:function(t,e,s){if(this.log.log(-1,"render_dropoff","enter > "+e.flow.length),l.Z.add(this.domNode,"MatcDashTaskPerfGramDropOff"),this.xLabel.innerHTML=this.getNLS("dash.perf.dropoff.xLabel"),this.xMaxLabel.innerHTML="100%",this.minLabel.innerHTML="",this._bars={},this._barLabels={},!this.funnel){var a=new p.Z;this.funnel=a.getFunnelSummary(t,e,s)}for(var i=0;i<this.funnel.length;i++){var n=this.funnel[i],o=n.p;if(n.event){var c=this.getNiceEventLabel(n.event,i),h=40*(i-1)+10+"px",d=this.db.div("MatcDashTaskPerfGramBar").build(this.canvas);d.style.top=h,d.style.left="0px",d.style.height="20px",d.style.width="0%",d.style.background=this.greenToRed(o),d.innerHTML=Math.round(100*o)+"%";var u=this.db.span("MatxAxisLabel MatcDashTaskPerfGramBarLabel MatcDashTaskPerfGramScatterHidden MatcDashTaskPerfGramBarLabelHidden",c).build(this.cntr);u.style.top=h;var f=Math.min(60*i,500);setTimeout(r.Z.hitch(this,"animateBar",d,u,Math.max(1,Math.min(99,100*o))+"%"),f),this._bars[i]=d,this._barLabels[i]=u}}},animateBar:function(t,e,s){t.style.width=s,l.Z.remove(e,"MatcDashTaskPerfGramBarLabelHidden")},clean_dropoff:function(t){if(this.log.log(-1,"clean_dropoff","enter"),l.Z.remove(this.domNode,"MatcDashTaskPerfGramDropOff"),this._barLabels)for(var e in this._barLabels){var s=this._barLabels[e];s.parentNode.removeChild(s)}if(delete this._barLabels,this._bars)for(var a in this._bars){var i=this._bars[a];i.style.width="0%"}setTimeout(r.Z.hitch(this,"removeBars"),200),this.setHint(),t&&setTimeout(t,200)},removeBars:function(){if(this._bars)for(var t in this._bars){var e=this._bars[t];this.canvas.removeChild(e)}delete this._bars},showSessionReplay:function(t,e,s){this.stopEvent(s),this.dialog&&this.dialog.close(),location.href=t},hoverPoint:function(t){this._selectedScatterPoint==t&&l.Z.add(this.cntr,"MatcDashTaskPerfGramCntrHover")},setHint:function(t){this.hintCntr.innerHTML="",t&&(this.hintCntr.appendChild((0,m.Xl)("PlayVideo")),this.hintCntr.appendChild(t))},clearPoint:function(){l.Z.remove(this.cntr,"MatcDashTaskPerfGramCntrHover")},setMiddle:function(t,e,s,a){this.setXMiddle(s,a),this.setYMiddle(t,e),l.Z.remove(this.cntr,"MatcDashTaskPerfGramCntrHover")},setYMiddle:function(t,e){this.yMiddleLabel.innerHTML=Math.ceil(t),this.yMiddleLabel.style.bottom=t/e*100+"%",this.yLine.style.bottom=t/e*100+"%"},setXMiddle:function(t,e){this.xMiddleLabel.innerHTML=Math.ceil(t/1e3)+" s",this.xMiddleLabel.style.left=t/e*100+"%",this.xLine.style.left=t/e*100+"%"},animateScatterPoint:function(t,e,s,a){t.style.bottom=e.interactions/a*100+"%",t.style.left=e.duration/s*100+"%"},getNiceEventLabel:function(t,e){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.model){var a=this.getScreenName(t.screen,!0),i=this.getWidgetName(t.widget,!0),n=[];if(t.widget){var o=s?" @ "+a:"";if("WidgetGesture"!=t.type||!t.gesture)return!t.state||"WidgetClick"!=t.type&&"WidgetChange"!=t.type?this.getEventLabel(t.type)+" -  "+i+o:this.getEventStateLabel(t.state)+" -  "+i+o;var r=t.gesture;n=[this.getGestureLabel(r.type),i]}else if("ScreenGesture"==t.type&&t.gesture){var l=t.gesture;n=["Screen "+this.getGestureLabel(l.type),a]}else n=[this.getEventLabel(t.type),a];return n[0]+" - "+n[1]}return this.getNLS("dash.perf.dropoff.step")+e}},mounted:function(){}},M=g,L=s(1001),k=(0,L.Z)(M,a,i,!1,null,null,null),x=k.exports},32023:function(t,e,s){s.d(e,{Z:function(){return C}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcTestSettings MatcDashTable"},[s("div",{attrs:{"data-dojo-attach-point":"tableCntr"}},[t.hasTests?s("div",[s("table",{staticClass:"vommondTable table is-hoverable"},[t._m(0),s("tbody",t._l(t.testSettings.tasks,(function(e,a){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(t.shorten(e.description)))]),s("td",[e.flow&&e.flow.length>0?[s("div",{staticClass:"StepCntr"},t._l(t.getTaskSteps(e),(function(e,a){return s("div",{key:a,class:"Step "+e.type},[a>0?s("span",{staticClass:"mdi mdi-arrow-right"}):t._e(),s("div",{staticClass:"StepDetails"},[t._v(t._s(t.shorten(e.label,20))+" ")])])})),0)]:s("span",{staticClass:"MatcHint"},[t._v("No steps ")])],2),s("td",{staticClass:" action"},[s("div",{staticStyle:{width:"100px",display:"flex","justify-content":"flex-end"}},[s("a",{staticClass:"MatcButton MatcButtonXXS MatcButtonSecondary",on:{click:function(s){return t.onEditTask(e,a,s)}}},[s("QIcon",{attrs:{icon:"EditSquare"}})],1),s("a",{staticClass:"MatcButton MatcButtonXXS MatcButtonDanger MatcButtonSecondary",on:{click:function(s){return t.onDelete(e,a,s)}}},[s("QIcon",{attrs:{icon:"DeleteTrash"}})],1)])])])})),0)]),s("div",{staticClass:"form-group mb-32"},[s("CheckBox",{attrs:{value:t.test.showTaskInTest,label:t.getNLS("testSettingsShowTaskInTest")},on:{change:t.onShowTaskChange}})],1),t.test.showTaskInTest?s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{value:t.test.showSuccessInTest,label:t.getNLS("testSettingsShowSuccessInTest")},on:{change:t.onShowSuccessInTest}})],1):t._e()]):s("p",{staticClass:"mb-32"},[t._v(" "+t._s(t.getNLS("testSettingsTaskAddHint"))+" ")])]),s("a",{staticClass:"MatcButton MatcButtonXXS",attrs:{"data-nls":"testSettingsAddTask"},on:{click:t.showCreateDialog}},[t._v("Add task")])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticStyle:{width:"20%"}},[t._v("Name")]),s("td",{staticStyle:{width:"30%"}},[t._v("Description")]),s("td",{staticStyle:{width:"35%"}},[t._v("Steps")]),s("td",{staticClass:"action",staticStyle:{width:"15%"}},[t._v("Action")])])])}],n=s(50124),o=s(48534),r=(s(68309),s(74916),s(77601),s(82526),s(41817),s(69826),s(41539),s(40561),s(99917)),l=s(93134),c=s(42477),h=s(24615),d=s(4623),u=s(14285),f=s(51804),p=s(55887),b=s(65454),v=s(37339),m=s(4951),g=s(75183),M=s(30512),L=s(96529),k={name:"TestSettings",props:["test","app","annotation","events","hash"],mixins:[v.Z,m.Z,r.Z],data:function(){return{testSettings:null,appID:"",userID:""}},components:{CheckBox:b.Z,QIcon:g.Z},computed:{pub:function(){return this.$route.meta&&this.$route.meta.isPublic},hasTests:function(){return this.testSettings&&this.testSettings.tasks&&this.testSettings.tasks.length>0}},methods:{shorten:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70;return t&&t.length>e?t.substring(0,e)+"...":t},getTaskSteps:function(t){var e=[];return t.flow.length>0&&e.push(this.createStep(t.flow[0])),t.flow.length>2&&e.push({type:"",label:"..."}),t.flow.length>1&&e.push(this.createStep(t.flow[t.flow.length-1])),e},createStep:function(t){return{label:t.widget?this.getWidgetName(t.widget):this.getScreenName(t.screen),type:t.widget?"widget":"screen"}},getScreenName:function(t){return this.app.screens[t]&&this.app.screens[t].name?this.app.screens[t].name:t},getWidgetName:function(t){return this.app.widgets[t]&&this.app.widgets[t].name?this.app.widgets[t].name:t},postCreate:function(){this.logger=new u.Z("TestSettings"),this.logger.log(4,"postCreate","enter > "+this.appID+" > "+this.pub),this.db=new p.Z,this.test&&this.setValue(this.test)},setValue:function(t){this.testSettings=t},render:function(t){this.cleanUpTempListener(),this.renderTaskTable(t)},onShowTaskChange:function(t){this.test.showTaskInTest=t,this.save()},onShowSuccessInTest:function(t){this.test.showSuccessInTest=t,this.save()},showCreateDialog:function(){var t=new f.Z,e=document.createElement("div");l.Z.add(e,"MatchTaskRecorderDialog");var s=this.$new(L.Z,{model:this.app,hash:this.hash});s.setValue({name:"Task "+(this.test.tasks.length+1),description:"",flow:[],strict:!1}),s.placeAt(e),t.popup(e,this.addBTN),t.own((0,h.Z)(t,"close",(function(){s.destroy()}))),t.own((0,h.Z)(s,"close",(function(){t.close()}))),t.own((0,h.Z)(s,"save",c.Z.hitch(this,"createNewTask",s,t)))},createNewTask:function(t,e){var s=this;return(0,o.Z)((0,n.Z)().mark((function a(){var i;return(0,n.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=t.getValue(),e.close(),s.test.tasks||(s.test.tasks=[]),s.test.tasks.push({name:i.name,description:i.description,id:"t"+Date.now(),strict:i.strict,flow:i.flow}),s.save();case 5:case"end":return a.stop()}}),a)})))()},onEditTask:function(t,e,s){var a=new f.Z,i=document.createElement("div");l.Z.add(i,"MatchTaskRecorderDialog");var n=this.$new(L.Z,{model:this.app,hash:this.hash,ignoreFirstEvent:!0});n.setValue(t),n.placeAt(i),a.popup(i,s.target),a.own((0,h.Z)(a,"close",(function(){n.destroy()}))),a.own((0,h.Z)(n,"close",(function(){a.close()}))),a.own((0,h.Z)(n,"save",c.Z.hitch(this,"updateTask",n,a)))},updateTask:function(t,e){var s=t.getValue(),a=this.test.tasks.find((function(t){return t.id===s.id}));a?(a.name=s.name,a.strict=s.strict,a.flow=s.flow,a.description=s.description,this.save()):console.error("AnalyticTaskList.saveFlow() > Cannot find task",s),e.close()},onDelete:function(t,e,s){var a=t.name?t.name:t.label,i=this.db.div("MatcDeleteDialog").build();this.db.h3("title is-4",this.getNLS("testSettingTaskDeleteTitle")).build(i),this.db.p("MatcMarginBottomXL",this.getNLS("testSettingTaskDelete1")+a+this.getNLS("testSettingTaskDelete2")).build(i);var n=this.db.div("MatcButtonBar").build(i),o=this.db.a("MatcButton MatcButtonDanger",this.getNLS("btn.delete")).build(n),r=this.db.a("MatcLinkButton",this.getNLS("btn.cancel")).build(n),l=new f.Z;l.own((0,h.Z)(o,d.Z.press,c.Z.hitch(this,"removeTask",e,l))),l.own((0,h.Z)(r,d.Z.press,c.Z.hitch(l,"close"))),l.popup(i,s.target)},removeTask:function(t,e){this.test.tasks.splice(t,1),e.close(),this.save()},save:function(){var t=this;return(0,o.Z)((0,n.Z)().mark((function e(){var s;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.pub){e.next=4;break}t.showSuccess(t.getNLS("testSettingsRegister")),e.next=8;break;case 4:return e.next=6,M.Z.getModelService().saveTestSettings(t.app.id,t.test);case 6:s=e.sent,"ok"===s.status&&(t.showSuccess("Saved.."),t.$emit("change",t.test));case 8:case"end":return e.stop()}}),e)})))()},_onEditFlow:function(t,e,s){for(var a=this.test.tasks,i=0;i<a.length;i++){var n=a[i];n.id==t.id&&this.onFlow(s,n,i)}},onFlow:function(t,e){this.showTaskFlow(t,e,this.app)},cleanUp:function(){this.cleanUpTempListener()}},watch:{test:function(t){console.debug("TestSetting.watch() > test",t),this.test=t,this.setValue(t)}},mounted:function(){}},x=k,S=s(1001),T=(0,S.Z)(x,a,i,!1,null,null,null),C=T.exports}}]);
//# sourceMappingURL=323-legacy.602ee078.js.map